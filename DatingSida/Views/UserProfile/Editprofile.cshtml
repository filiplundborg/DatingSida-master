@model DatingSida.Models.EditUserProfileViewModel
@using Microsoft.AspNet.Identity;

@{
    ViewBag.Title = "Ändra uppgifter";
}


<h2>@ViewBag.Title.</h2>

@using (Html.BeginForm("EditProfile", "UserProfile", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
    @Html.AntiForgeryToken()
    <h4>Ändra dina uppgifter</h4>
    <hr />
    @Html.ValidationSummary("", new { @class = "text-danger" })
    <div class="form-group">
        @Html.LabelFor(m => m.Email, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            @Html.TextBoxFor(m => m.Email, new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Password, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            <input type="button" class="btn btn-default" id="TheButton" value="Ändra lösenord" />
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.Username, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            @Html.TextBoxFor(m => m.Username, new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Firstname, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            @Html.TextBoxFor(m => m.Firstname, new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Lastname, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            @Html.TextBoxFor(m => m.Lastname, new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Gender, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            @Html.EnumDropDownListFor(m => m.Gender, "Välj ditt kön", new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(m => m.Description, new { @class = "col-md-2 control-label" })
        <div class="col-md-10">
            @Html.TextAreaFor(m => m.Description, new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">

            <input type="submit" class="btn btn-default" value="Spara" />
        </div>
    </div>
}


@using (Html.BeginForm("SerializeProfile", "UserProfile", FormMethod.Post, new { @class = "form-horizontal", @id = "download-profile", role = "form" }))
{<div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" class="btn btn-default" value="Serialisera profil till XML" id="SerializeButton" />
            @{string file = User.Identity.GetUserName().ToString() + "'" + ".xml";
                string fp = Path.Combine(Server.MapPath("~/ProfilesXml/"), file);
                if (File.Exists(fp))
                {
                    <a class="btn btn-default" href="../ProfilesXml/@Model.Username'.xml" download id="DownloadLink">Ladda ner mig</a>
                }
            }
            
        </div>
    </div>
}




@using (Html.BeginForm("LogOffDelete", "Account", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{<div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" class="btn btn-default" value="Ta bort min användare" />
        </div>
    </div>
}


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>


        $('#TheButton').click(function () {
            window.location.href = '../Manage/ChangePassword';

        });
            //$('#download-profile').on("click", function () {
            //    $("#DownloadLink").fadeToggle(500);
            //});


    </script>

}
